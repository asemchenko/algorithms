Поменяй rand на что-то нормальное
Выясни почему сортировка вставками работает быстрее чем выбором